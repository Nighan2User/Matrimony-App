<!DOCTYPE html>
<html lang="en">
<head>
  <base href="/">
  <meta charset="UTF-8">
  <meta content="IE=Edge" http-equiv="X-UA-Compatible">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="Bright Weddings - Find your perfect match">
  
  <!-- Preconnect to critical origins -->
  <link rel="preconnect" href="https://fonts.googleapis.com" crossorigin>
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link rel="preconnect" href="https://firebasestorage.googleapis.com" crossorigin>
  
  <!-- DNS prefetch for Firebase -->
  <link rel="dns-prefetch" href="https://firestore.googleapis.com">
  <link rel="dns-prefetch" href="https://identitytoolkit.googleapis.com">
  
  <!-- iOS meta tags & icons -->
  <meta name="mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  <meta name="apple-mobile-web-app-title" content="Bright Weddings">
  <link rel="apple-touch-icon" href="icons/Icon-192.png">

  <!-- Favicon -->
  <link rel="icon" type="image/png" href="favicon.png">

  <title>Bright Weddings</title>
  <link rel="manifest" href="manifest.json">

  <!-- Critical CSS for loading screen - inlined for fastest first paint -->
  <style>
    :root {
      --primary-color: #E91E63;
      --bg-color: #FFF8F9;
    }
    
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    
    html, body {
      height: 100%;
      width: 100%;
      overflow: hidden;
      background-color: var(--bg-color);
    }
    
    .loading-container {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      background: linear-gradient(135deg, var(--bg-color) 0%, #FCE4EC 100%);
      z-index: 9999;
      transition: opacity 0.3s ease-out;
    }
    
    .loading-container.fade-out {
      opacity: 0;
      pointer-events: none;
    }
    
    .loading-logo {
      width: 120px;
      height: 120px;
      margin-bottom: 24px;
      animation: pulse 1.5s ease-in-out infinite;
    }
    
    .loading-text {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      font-size: 24px;
      font-weight: 600;
      color: var(--primary-color);
      margin-bottom: 32px;
    }
    
    .loading-spinner {
      width: 48px;
      height: 48px;
      border: 4px solid #FCE4EC;
      border-top-color: var(--primary-color);
      border-radius: 50%;
      animation: spin 1s linear infinite;
    }
    
    .loading-progress {
      margin-top: 16px;
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      font-size: 14px;
      color: #888;
    }
    
    @keyframes spin {
      to { transform: rotate(360deg); }
    }
    
    @keyframes pulse {
      0%, 100% { transform: scale(1); opacity: 1; }
      50% { transform: scale(1.05); opacity: 0.8; }
    }
  </style>
</head>
<body>
  <!-- Loading screen shown while Flutter initializes -->
  <div id="loading" class="loading-container">
    <svg class="loading-logo" viewBox="0 0 100 100" fill="none" xmlns="http://www.w3.org/2000/svg">
      <circle cx="50" cy="50" r="45" fill="#FCE4EC"/>
      <path d="M50 25C38.954 25 30 33.954 30 45C30 60 50 75 50 75C50 75 70 60 70 45C70 33.954 61.046 25 50 25ZM50 52C46.134 52 43 48.866 43 45C43 41.134 46.134 38 50 38C53.866 38 57 41.134 57 45C57 48.866 53.866 52 50 52Z" fill="#E91E63"/>
    </svg>
    <div class="loading-text">Bright Weddings</div>
    <div class="loading-spinner"></div>
    <div id="loading-progress" class="loading-progress">Loading...</div>
  </div>

  <script>
    // Performance: Track loading time
    window._loadStart = performance.now();
    
    // Update loading progress
    function updateProgress(msg) {
      const el = document.getElementById('loading-progress');
      if (el) el.textContent = msg;
    }
    
    // Hide loading screen when Flutter is ready
    window.addEventListener('flutter-first-frame', function() {
      const loading = document.getElementById('loading');
      if (loading) {
        loading.classList.add('fade-out');
        setTimeout(() => loading.remove(), 300);
      }
      console.log('Flutter loaded in', Math.round(performance.now() - window._loadStart), 'ms');
    });
  </script>

  <script>
    // Flutter initialization with optimized settings
    window.addEventListener('load', function() {
      updateProgress('Initializing...');
      
      // Load Flutter bootstrap
      var script = document.createElement('script');
      script.src = 'flutter_bootstrap.js';
      script.async = true;
      script.onload = function() {
        updateProgress('Starting app...');
      };
      document.body.appendChild(script);
    });
  </script>

  <!-- Fallback for very slow connections -->
  <noscript>
    <style>
      .loading-container { display: none !important; }
    </style>
    <p style="text-align: center; padding: 20px;">
      This application requires JavaScript to run. Please enable JavaScript in your browser.
    </p>
  </noscript>
</body>
</html>
